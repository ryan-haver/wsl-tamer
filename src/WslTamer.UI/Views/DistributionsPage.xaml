<UserControl x:Class="WslTamer.UI.Views.DistributionsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:converters="clr-namespace:WslTamer.UI.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:StateToColorConverter x:Key="StateToColorConverter"/>
    </UserControl.Resources>
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,0,0,10">
            <Button Content="Install New" Click="BtnInstallDistro_Click" Margin="0,0,10,0" ToolTip="Install a new distribution from the online registry."/>
            <Button Content="Import Distro" Click="BtnImportDistro_Click" Margin="0,0,10,0" ToolTip="Import a distribution from a .tar file."/>
            <Button Content="Refresh" Click="BtnRefreshDistros_Click" ToolTip="Reload the list of distributions."/>
        </StackPanel>
        
        <ScrollViewer Grid.Row="1">
            <ItemsControl Name="IcDistros">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <ui:Card Margin="5" Width="320" Padding="10">
                            <StackPanel>
                                <DockPanel LastChildFill="False">
                                    <TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="16"/>
                                    <TextBlock Text="â˜…" Visibility="{Binding IsDefault, Converter={StaticResource BooleanToVisibilityConverter}}" DockPanel.Dock="Right" Foreground="Gold" ToolTip="Default Distribution"/>
                                </DockPanel>
                                <TextBlock Text="{Binding State}" Margin="0,5,0,0" Foreground="{Binding IsRunning, Converter={StaticResource StateToColorConverter}}"/>
                                <TextBlock Text="{Binding Version, StringFormat='WSL {0}'}" Margin="0,0,0,10" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                                
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,5">
                                    <Button Content="Run" Margin="0,0,5,0" Tag="{Binding Name}" Click="BtnRunDistro_Click" ToolTip="Start this distribution in a new terminal window."/>
                                    <Button Content="Stop" Margin="0,0,5,0" Tag="{Binding Name}" Click="BtnStopDistro_Click" ToolTip="Terminate this distribution."/>
                                    <Button Content="Settings" Margin="0,0,5,0" Tag="{Binding Name}" Click="BtnDistroSettings_Click" ToolTip="Configure wsl.conf for this distribution."/>
                                    <Button Content="Set Default" Tag="{Binding Name}" Click="BtnSetDefaultDistro_Click" ToolTip="Make this the default WSL distribution."/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Content="Clone" Margin="0,0,5,0" Tag="{Binding Name}" Click="BtnCloneDistro_Click" ToolTip="Create a copy of this distribution."/>
                                    <Button Content="Move" Margin="0,0,5,0" Tag="{Binding Name}" Click="BtnMoveDistro_Click" ToolTip="Move this distribution to another drive or folder."/>
                                    <Button Content="Export" Margin="0,0,5,0" Tag="{Binding Name}" Click="BtnExportDistro_Click" ToolTip="Backup this distribution to a .tar file."/>
                                    <Button Content="Unregister" Tag="{Binding Name}" Click="BtnUnregisterDistro_Click" Background="#33FF0000" BorderBrush="Red" ToolTip="Permanently delete this distribution."/>
                                </StackPanel>
                            </StackPanel>
                        </ui:Card>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</UserControl>
